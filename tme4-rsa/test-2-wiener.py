from rsa import *
print("\n\n----------------------------------------------\n\n")

print("Test 1 : Exercice 1 - RSA")

print("---------------------")

print("Test fractions")

q = 312553348843938863456890759492315774421095939354281621462969503748428582110263873756299677099599930962645204258159351520115809191883751199613816245423443683692786396662819574923837123656293776196870493421292993497974720986668507583776097830164675146091639593936576812601819298705922407564737940438249808942073
p = 286117684608630646119798881654882640931150829639150536632023273927318179411589849204972605539880890084548473585054532341819379288942285138741472564501465250815779461057019488143700396818207306608900037653818288362642548481088419227087838392036758735837958174552404528860014140405524831483649300789742651444231
F = cfrac(q, p)
assert F == [1, 10, 1, 4, 1, 1, 1, 8, 1, 42, 5, 2, 39, 2, 1, 1, 6, 2, 1, 15, 2, 1, 5, 1, 3, 2, 1, 3, 9, 2, 2, 95, 2, 1, 304, 1, 2, 1, 7, 1, 1, 8, 1, 2, 2, 14, 6, 1, 1, 2, 5, 1, 2, 4, 1, 1, 3, 1, 220, 3, 2, 3, 7, 1, 1, 1, 1, 4, 1, 1, 22, 1, 1, 8, 1, 11, 2, 1, 13, 3, 1, 3, 3, 1, 1, 3, 1, 1, 4, 1, 1, 2, 5, 2, 4, 6, 2, 3, 5, 11, 1, 1, 2, 5, 1, 8, 2, 1, 1, 1, 24, 1, 2, 1, 2, 1, 1, 9, 1, 24, 1, 1, 2, 1988, 13, 3, 1, 1, 1, 1, 12, 1, 2, 7, 1, 1, 1, 2, 3, 1, 1, 1, 3, 1, 2, 39, 1, 4, 1, 3, 1, 30, 1, 5, 1, 1, 3, 5, 1, 1, 1, 6, 1, 3, 1, 11, 425, 1, 1, 5, 1, 32, 10, 12, 8, 1, 1, 1, 1, 55, 20, 4, 1, 4, 10, 3, 1, 2, 3, 1, 1, 8, 7, 6, 8, 1, 21, 1, 6, 2, 5, 2, 10, 1, 4, 1, 95, 1, 1, 1, 18, 7, 7, 2, 2, 1, 1, 12, 4, 8, 10, 1, 2, 1, 31, 9, 1, 3, 41, 1, 8, 1, 3, 1, 2, 1, 6, 9, 1, 210, 1, 5, 2, 2, 1, 1, 3, 1, 3, 14, 1, 18, 3, 1, 3, 13, 1, 4, 2, 55, 6, 2, 3, 2, 18, 1, 1, 11, 1, 6, 1, 1, 6, 2, 1, 2, 9, 9, 2, 9, 3, 3, 1, 1, 1, 2, 13, 1, 22, 1, 92, 1, 6, 2, 1, 1, 3, 4, 1, 1, 5, 1, 1, 17, 1, 3, 1, 3, 3, 4, 1, 4, 1, 1, 1, 2, 1, 20, 6, 2, 2, 1, 1, 1, 2, 1, 4, 2, 3, 3, 2, 4, 2, 1, 22, 1, 1, 3, 1, 16, 1, 3, 7, 1, 11, 1, 4, 1, 2, 5, 3, 1, 4, 2, 5, 2, 5, 6, 2, 1, 2, 1, 1, 1, 1, 1, 12, 2, 1, 51, 1, 5, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 18, 1, 11, 8, 1, 1, 3, 1, 1, 1, 22, 1, 1, 1, 4, 1, 3, 2, 6, 4, 1, 1, 1, 1, 3, 6, 3, 1, 1, 10, 1, 3, 4, 1, 1, 8, 26, 1, 3, 2, 2, 1, 1, 3, 5, 3, 1, 1, 14, 2, 4, 1, 3, 13, 1, 3, 5, 1, 2, 1, 15, 1, 2, 1, 18, 1, 4, 10, 1, 1, 11, 17, 1, 4, 2, 4, 2, 1, 1, 16, 1, 4, 6, 1, 2, 2, 2, 125, 1, 18, 1, 5, 1, 1, 42, 1, 1, 5, 1, 7, 1, 6, 8, 1, 27, 1, 1, 8, 2, 4, 3, 1, 118, 7, 1, 1, 43, 4, 9, 1, 2, 3, 2, 11, 1, 2, 27, 1, 3, 1, 1, 3, 1, 4, 6, 2, 5, 1, 1, 2, 2, 1, 1, 20, 1, 3, 7, 2, 1, 2, 41, 1, 5, 7, 1, 8, 2, 5, 1, 1, 1, 1, 73, 1, 2, 5, 3, 6, 1, 1, 4, 5, 1, 1, 1, 4, 1, 6, 1, 3, 1, 2, 1, 26, 2, 3, 3, 2, 2, 6, 1, 51, 2, 18, 2, 1, 6, 3, 1, 2, 4, 5, 1, 1, 5, 1, 1, 1, 14, 6, 1, 17, 1, 1, 1, 2, 1, 1, 2, 1, 3, 1, 1, 1, 1, 3, 3, 20]

print("Test fractions : OK")

print("---------------------")

print("Test Wiener")

m = 139152838736659961467978317975335396706400090424984484625312127875313655009391880773444091739961779658488539672497172177142243165734775095177963115572052916663602817232622208611013680985069331286181320397961138189963959641530126067756636977329649590628615293675778180791887501360671801001931058291317911314141
c = 38707439148585039367797844206453062955272726626496150935170106183954765785201917206852318080174230521542242393539049321841609237011816956801844511980721623581049387534739408307552747407450043003337376635727364241914086576852254621320473523328216579404419819095948929711889069328069513040889312148988836396304687012245262989226915286757207941712119632729346322679908370903158950785300751231269227383920484472462950174064027672812865496528956458536073613459173266161899308814814086137805271361925258902835024544353196814076098321780969719479693271269549465628136178351912631968323848360627853039394098009368784932940502
N = 70551902728011071283658591747362921139628095498695468899132140736873910932586994833118954706349221147311754439127164784932926630762898814740804370698680677819019463090397726621125294890996469510341074267773439306607801394819549787495298708237819374767554770044224231471218469213408645502390950477180850399197942859310080401712168929350081642236674068972534736941505850118341202346016538852604780026769311202819047580501671680596858424634345356958611877785513274335915346036352884314029634561631476368538058435101488828449627690194049034172008472543867212074468910613855936449266475160693508601580341500062117760345559
e = 38482856033460584336541050044016138803433506635652073944981167674658496872320178999883066203463211534897320603160271700872505434961581171676802384017462187901283343503853305429704706304179892460186040509694603258149709851719754429542890204493356022600484420024122308075210074116404715728576882078462282035925860617946716695142813613172528639548400646691706681730104240530240909104447861756038727718123889560259509163953590142740953949106550574247363681518678919298688608650878052650033707623869012537324128048330438729902788131087121593483614618446514221205433420533893291492317149584752522841733211896383575890312371
assert Wiener(m, c, N, e) == 11

m = 71179278146128337137232450077534450448109554367859028320209243049084376423366158693297243607643671880264524554606562575942622552396549178788374421131735596916707464031880974995607338819315256404436302655301301685026197319577831398056845821423006017632105531982796856228480405582988860578340451864001252132440
c = 39511744875896280854969408602794430199736953204409833567230444283288329193421673252907392299235386311057261708884184069196843023374553247145942525883445335773467647045559303664546659304004970129026433689986380594136825069597755660202340077785919731784473244094198486215587437313125517272677788577626913354405555884886529717574521189041593117411530254579230287519378971462733294195992899334430170812785173042485612854259425924804479480903110242654544845400408158067531994454915043459276624586386067376104908395744510738515942615172993000659592229487660334989845516010292736979261039503450058680855342252767770177994987
N = 72643885839798382965698294310345353899784392758054284814172282074425546416070757077208722964218876032173918542752334198308060111100880000670037630915686136491794906906835446204510814914349671638315010266028679737466041440893066990018063716044719982749780317931381104229463628147892711923750886026103105843428949017499479244068142714155511406333074076245828574877167291100205039630321046101230767010917478779657193090842003018652311205678167464121847963982322337055438313076506817282083972164293512314172886759142710698902898445939431529880959830930067446352853181969323095163578647451092444990969135362031893153502771
e = 16775572038617297615406412173740849709708472458509702028339402822952006268599742933578132748190143863019503210151855733059574708080759605333881935296226681837943717861018470787327311917169043021690774139233469241659099887548685327799691239008413547214394833842249482081487675438015184647296856726900713823027272319722249443277413282838028483734970736955740077374997145160335674535093074500969175657896073568022471584688559571334086530260079778293124343744977061428240971915759543948193080854366298619015856601603742277107747235540678585747128938232110730579110697884689123988586303642907135359370234572997340943664801
assert Wiener(m, c, N, e) == 21267647932558653966460912964485513217

print("Test Wiener : OK")


print("---------------------")

print("\n\n----------------------------------------------\n\n")
