from rsa import *
print("\n\n----------------------------------------------\n\n")

print("Test 1 : Exercice 1 - RSA")

print("---------------------")

print("Test RSA")
assert rsa_chiffrement(170739803632679445077058424866270305137906509001526272042002578605776780573109112348633484516112062119873491038182770796489576298689080017575224788011362234172229493993832445339825556958875381210553026174251425060488634759826001048915898021256878410207330848777479867187161890705374676725493445220844514584561, 86254937998788194207285572046069040201486874218711848423211436206961839919272340317840458973523842469142828144466024384473093791186073777198589716262532759827308708270441777529591204630288739529362247626349569136129510955651331822493333780815970080367517450070753931779536982615147307104964294324158190631085771426288092091907868279867213826834273804000752414933437594875803414082728020320066494772191649049832025929600798915415984278686512221054486699234665193982030546555938130682304586961978025875591477906872039337758509238779382591787357934154049165808539751901551789659148074938330499417620897910876992540540183, 107810928263992119912954681339251997386083130990223629750855447887341743142612767670749276869127605412202520457433350442821559196200309322779445660266992696805588972437028780093200761843945310333202810857534592665223144898020515169033888408575921489718166555546276760039691679837316247234394221573556647120773) == 59803639525965570516888043459025839373304672489360295926997250027265278765342143690385304628395750104129640508150772585264634728626262151026864272133010284469584497646653939203136983313666665349645382722688397945795079104613151729983998893123182457542855862258935782066631301625612023679799161904951882690180958624460411666503071653930071799705073397434322617131477227582371194819550453968312021068805857584551511503028246945193345948256673043035398818763339815408475260163284832701087947207468556352775570171375488280506339148505050891728559383528719922583416810258391728128203276071833193834303169458995123262465439
assert rsa_chiffrement(82240445509382862593712418181981486627540639131791551224532895556953339241084198191589461135082162457996448722641277403182705501051379863984560314271297095879443257872061720862332689638826519061440620206893941046845242492627320459939745266487763906369285156446689464855149249265944756095674374497758955401192, 86254937998788194207285572046069040201486874218711848423211436206961839919272340317840458973523842469142828144466024384473093791186073777198589716262532759827308708270441777529591204630288739529362247626349569136129510955651331822493333780815970080367517450070753931779536982615147307104964294324158190631085771426288092091907868279867213826834273804000752414933437594875803414082728020320066494772191649049832025929600798915415984278686512221054486699234665193982030546555938130682304586961978025875591477906872039337758509238779382591787357934154049165808539751901551789659148074938330499417620897910876992540540183, 71381594796106668927028833200028042666243588188098202650023470010050501078116707931112402156849995426547641687699190176052812838266524387326633319007805880309412177387870155994498877391928251717548835294416716694422670629788777209905393906565334534616494749380313489234167789926260253833396594615005309611823) == 12461258433195184323803600055886138907172680807611755047261135635088142380088226923687331572307603334407491865072906366527672252910168561136156107212950463314473301305189809978573259852608486245158587987887770675744335025614844104518563991613601038869865498064183627560267720503728842961810957732334530624950459603948911134450352026355909252444842820304830295758137838362146538495568832641190301013272320081784689789833641281786611865995091877029307856252895463630409065758258607199296619408565563738990462796702818359392317011991943856400947569965269288437361757236263116120511983697994590971320761296441465664430487
assert rsa_chiffrement(102937038384345817977193138893551818716741050743027306054876593886744007204056500234082861712069409167308605914356908922580383597599827137863702296983370442219447235370725010999041597976095606812704353246459937511545580712445900080650043738370886749142806608213854929241605245891743956534150668250957127289393, 86254937998788194207285572046069040201486874218711848423211436206961839919272340317840458973523842469142828144466024384473093791186073777198589716262532759827308708270441777529591204630288739529362247626349569136129510955651331822493333780815970080367517450070753931779536982615147307104964294324158190631085771426288092091907868279867213826834273804000752414933437594875803414082728020320066494772191649049832025929600798915415984278686512221054486699234665193982030546555938130682304586961978025875591477906872039337758509238779382591787357934154049165808539751901551789659148074938330499417620897910876992540540183, 171948633253149782228650249570656600748149355061881402135932367785557587844143941156500613756301890450728601137959304794853107192442146040273320927298201965401599475549967863631484057488264779793628860712814834422099323572706393156913607297981908033003454538355928922950229698337609807699756131697673254622709) == 80253741318782158550209934736414738997558402173258043843583495205355153151602686927107456160586946393815661971011984828210980734838465582287687743536289190480927649035576774538056699956472942473093403831907455445163103416667415179103153108357565803396316614080506905268907579031743390106610711075935337226733764414388800456402809116724298513521604071105915595963868368077446769363805639145964365284795952911039459017852798467315662921257617505027479039299109308323238942794013843028135609823260036952719228348053225347045562386547720084153516054282555772373581693237038221586052076275390837957562036894748225209361412

assert rsa_dechiffrement(31170942855120968211636757496900365331134357319920086117695708350076169357179128179058048492394416912489740691837900488050193627881867822057434921590333106774794281404559164429178941240758126927894375420000780044038696372174498746065439888105247647887949257411866047333124492730729202335538807451357534684435, 275968689242412121780747684036783237957961805168628758868216573901079536484220155890550681492148916868708961070443087550465810085853973440693678823494737748650503568297216218549049525881711538066714441499834697996162642990853428058777804098350912497861668639642109296018819604256474981874716929132651970461071, 312553348843938863456890759492315774421095939354281621462969503748428582110263873756299677099599930962645204258159351520115809191883751199613816245423443683692786396662819574923837123656293776196870493421292993497974720986668507583776097830164675146091639593936576812601819298705922407564737940438249808942073, 84761836841305505546557093368365903940338891849585776116630033837079849856319772421678471754602213580790850362053039263919488678945329221248457503350863102689235983953254851140924979001017071698591053177683974908521626461619588573271730545873875299799340452231354015624370068789420974925773247553644730747506875421212772032677152462396134746612859046162487137553097229791794746883144319367142693340159708180957005190638795838538941275409458148063930861838167490150109470323566640432064473291552953869245094075308208771931189562563495718646713044320993507394097512041476907610721998745813065240175102862422563478268340) == 40641828262202214492058623525395314263724957996557416291992784220566384285809098083539646951443820765782529564994343367724215495956478253634176000251380923211710302122240859267110071554615333561982469712968193684241114204706811077425137301821904395126616009099288058998105245219862776504895274967407294062656425227928321797797890626251225168203531539947424815157693779084685118704438239137283085239438961513613915270753389733776611815622152750478181114315912890106214399517361378611624455780356410170145111247462918903366847931923007545253490752095680246669707213365889331096098885901664699929297561526830289400816136
assert rsa_dechiffrement(132454209555464590107692479196754453118551377761005715027436361596819526872596328860887608649313072204681459435771012995879879086107490847466472179195391591105048852696188345709575319674321246484829121209607979095994649859032061832021810270357284041459645027919589097700279455153068505898910069490047949179956, 275968689242412121780747684036783237957961805168628758868216573901079536484220155890550681492148916868708961070443087550465810085853973440693678823494737748650503568297216218549049525881711538066714441499834697996162642990853428058777804098350912497861668639642109296018819604256474981874716929132651970461071, 312553348843938863456890759492315774421095939354281621462969503748428582110263873756299677099599930962645204258159351520115809191883751199613816245423443683692786396662819574923837123656293776196870493421292993497974720986668507583776097830164675146091639593936576812601819298705922407564737940438249808942073, 34871903190428965659127623294639546251170820704311502912609656044694329647591091351309845674114567636272134314938184827514814875388319514937037364266357215869891175533379708116321260510161081434640853563639190097595555290657336420893061986830646974211580696783912657939358307082992212238555703239410062129781713796142448814948316618760966477860809388261776238351044941711564125498296582763906680943315292674471229109941837381272284071444194356330677097797436294427327408612273917737048653471019260724689778661177613791816262974122715601794961256444456180823465880944737291367082738176232485048120803388303105975023567) == 39837328972415467086395751710582983268757921841399895248813351105675000144792532389092332668589910915855283998445833969232495298206155478654513131204402329663531358473030836415675340638389036518190592114388634418109409979651453469625209151092771715782322219148162155623561146656814575772237309244268498244457162935815140503131740673333098843457453091022171661809507793140464184459296346916481840786733796217718222596636896578861365034185687224783347411235208860483034330802748495100222913103269698163001168517992836214359268187413638490962846225500085954996550543710609338138538487569894130856868983565343083046075331
assert rsa_dechiffrement(51757824151052814568636602567216320603355014841268424175832285266682888690938317045836788537826296203445126955809528881525566900494520540996159609563236245484594897584569652582717970740172918670307249624644368302321778599233831902860633245829044230945282887706449022787201635029854109319126624050860795783616, 275968689242412121780747684036783237957961805168628758868216573901079536484220155890550681492148916868708961070443087550465810085853973440693678823494737748650503568297216218549049525881711538066714441499834697996162642990853428058777804098350912497861668639642109296018819604256474981874716929132651970461071, 312553348843938863456890759492315774421095939354281621462969503748428582110263873756299677099599930962645204258159351520115809191883751199613816245423443683692786396662819574923837123656293776196870493421292993497974720986668507583776097830164675146091639593936576812601819298705922407564737940438249808942073, 68387567413066238608260597528913268213350935765610205487777815914112643535727575747110749215686849951712803749398623416280878719167047321530011897641801381760941288758371120451003042321451808260349366879168846462912015997490514522536295554024177911397196701565513142517859159650907789003769528716237480349637115029023329799745973226621806759963365175583044331968279237050903558943332459418226327685724946505280768815992431194830148342587387951838848918589848975094484434208698107443356004126268610068836005485752412682015389633705070020050324871703968781019964820448137212116244223760053317174310058202997658609177892) == 30115096472138509929153880808579721495064784229042610834810101714157004451321457478813522538913520254412460326068343595622311342599779714737878601998653614990739910644492362015698459531163335039052357465933589658583438730879623572725762054183215863530901066442716951182742984498042930245554461373718857916991964124825198898987067989841367024005379089415591372684387645000494919818905363187450031159273416625648998116233962920097007174211298981777746072519553489111368603179067153558663908092723397650365374277926521375461671454900661186296285432123025325845393835304848180645940050586228597938562042422002553813194959
print("Test RSA : OK")

print("---------------------")

print("Test crt")

a, b = 62779176902193414369316575487557551595052666038579993587589020510597249243648566181615026046457743553998946266890691165767666906946273142702015525953039857453313026003694532130679286020478798736608765172706292687033444456142280059321331222313230661413141705672046697390036585286402668957157234716448855719617, 105597949427650585043537378942451800703522526792813100335128852239300093963049590462534100755762072751425648407658348204612279109736306532985411789327523405110912908896644969155814428655249897916936762796230350206428344575732220062293659125833970120279664089168495711966564087987459773266623449249328159516711
n, m = 275968689242412121780747684036783237957961805168628758868216573901079536484220155890550681492148916868708961070443087550465810085853973440693678823494737748650503568297216218549049525881711538066714441499834697996162642990853428058777804098350912497861668639642109296018819604256474981874716929132651970461071, 312553348843938863456890759492315774421095939354281621462969503748428582110263873756299677099599930962645204258159351520115809191883751199613816245423443683692786396662819574923837123656293776196870493421292993497974720986668507583776097830164675146091639593936576812601819298705922407564737940438249808942073
s, _ = crt2(a, b, n, m)
assert s % n == a
assert s % m == b

# a, b = 7, 3
# n, m = 8, 14
# s, _ = crt2(a, b, n, m)
# assert s % n == a
# assert s % m == b

print("Test crt : OK")

print("---------------------")

print("\n\n----------------------------------------------\n\n")
